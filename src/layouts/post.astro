---
import { getEntry, type CollectionEntry } from 'astro:content'
import BaseHead from '../components/BaseHead.astro'
import DateTime from '../components/DateTime.astro'
import MainLayout from '../components/MainLayout.astro'
import Prose from '../components/Prose.astro'
import { SITE, USE_POST_IMG_OVERLAY } from '../config'

interface Props {
    meta?: {
        id: string
        slug: string
        collection: string
    }
    content: CollectionEntry<'blog'>['data']
}
const { content, meta } = Astro.props
const series = content.series ? await getEntry(content.series) : undefined
---

<!doctype html>
<html lang="en">
    <head>
        <BaseHead
            {...content}
            title={content.title
                ? `${SITE.title} | ${content.title}`
                : SITE.title}
        />
    </head>
    <MainLayout>
        <div class="post__header">
            <div class="post__tags">
                {
                    content.tags.length > 0 &&
                        content.tags.map((tag) => (
                            <a
                                class="post__tag"
                                href={`/tags/${tag}`}
                                title={tag}
                            >
                                {tag}
                            </a>
                        ))
                }
            </div>
            <h1 class="post__title">{content.title}</h1>
            {
                series && (
                    <h4 class="post__series">
                        Uit de serie:{' '}
                        <a href={`/series/${series.slug}`}>
                            {series.data.title}
                        </a>
                    </h4>
                )
            }
            <h5 class="post__desc">
                <div>
                    <span class="post__date">
                        <!-- post creation/updation data -->
                        <DateTime value={content.date} />
                    </span>
                </div>
            </h5>
        </div>
        {
            content.image ? (
                USE_POST_IMG_OVERLAY ? (
                    <>
                        <div class="img__outer">
                            <img src={content.image} alt={content.title} />
                            <div class="img_gradient" />
                        </div>
                        <br />
                    </>
                ) : (
                    <>
                        <img
                            class="img__outer"
                            src={content.image}
                            alt={content.title}
                        />
                        <br />
                    </>
                )
            ) : (
                ''
            )
        }
        <Prose>
            <slot />
        </Prose>
        <div class="post__footer"></div>
    </MainLayout>
</html>
<style>
    .post__header {
        @apply py-4 mb-1 text-center md:text-left;
    }
    .post__title {
        @apply text-5xl font-extrabold text-theme-primary dark:text-theme-dark-primary;
    }
    .post__desc {
        @apply text-gray-500 dark:text-gray-100 flex justify-center text-left md:flex-none md:justify-start;
    }
    .post__date {
        @apply text-gray-400;
    }
    .post__tags {
        @apply inline-flex gap-2;
    }
    .post__tag {
        @apply text-gray-400 hover:text-theme-primary dark:hover:text-theme-dark-primary;
    }

    .img__outer {
        @apply relative rounded-lg shadow-xl overflow-hidden;
    }
    .img_gradient {
        @apply absolute z-10 w-full bottom-0 left-0 h-full bg-gradient-to-tr from-theme-primary dark:from-theme-dark-primary;
    }
</style>
